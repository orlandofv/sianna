{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords"
        content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Monsterlite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Monster admin lite design, Monster admin lite dashboard bootstrap 5 dashboard template">
    <meta name="description"
        content="Monster Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
    <meta name="robots" content="noindex,nofollow">
    <title>
        {% block title %}
            SIANNA - Component Management
        {% endblock title %}
    </title>

    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href=" {% static 'assets/images/favicon.png' %}">
    <!-- Custom CSS -->
    <link href=" {% static 'assets/plugins/chartist/dist/chartist.min.css' %}" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{% static 'css/style.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static '/DataTables/datatables.min.css' %}">
    <!-- HTML5 Shim and Respond.js' %} IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js' %} doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js' %}"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js' %}/1.4.2/respond.min.js' %}"></script>
<![endif]-->
    <script src="{% static 'js/chartjs/chart.min.js' %}"></script>

<style>
    .contentContainer
    {
        border-radius: 10px;
        background-color: #fff;
        padding: 15px;
        margin-left: 20px;
        margin-right: 20px;
        margin-bottom: 20px;
    }
</style>

</head>

<body style="background-color: white;">
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div>
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->

    {% block layout %}
    {% endblock layout %}


    {% block jsscripts %}
        {% include 'scripts.html' %}
    {% endblock jsscripts %}

    <script type="text/javascript">
        function Hide(HideID) 
        {
            HideID.style.display = "none"; 
        }

        var html = '';
        html += '<div id="inputFormRow" class="row m-0 p-0">' 
        html += '<div class="form-group col-md-12 mb-0">' 
        html += '<div id="div_id_action" class="mb-3">' 
        html += '<label for="id_action" class="form-label requiredField">'
        html += 'Action<span class="asteriskField">*</span>' 
        html += '</label>' 
        html += '<div class="input-group">' 
        html += '<input type="text" name="action" maxlength="255" class="textInput form-control" required id="id_action">'
        html += '<button  class="btn btn fa fa-minus-circle" id="removeRow" type="button"></button>'
        html += '</div>' 
        html += '</div>' 
        html += '</div>' 
        html += '</div>'      

        // add row
        $("#button-id-add_action").click(function () {
            $('#add_action').append(html);
            // $('#div_id_action').clone().appendTo('#formRow');
        });
    
        // remove row
        $(document).on('click', '#removeRow', function () {
            $(this).closest('#inputFormRow').remove();
        });
        
        var item_html = '';
        item_html += '<div id="itemFormRow" class="row m-0 p-0">'
        item_html += '<div class="form-group col-md-6 mb-0" >' 
        item_html += '<div id="div_id_item" class="mb-3">' 
        item_html += '<label for="id_item" class="form-label requiredField">'
        item_html += 'Item<span class="asteriskField">*</span>' 
        item_html += '</label>' 
        item_html += '<input type="text" name="item" maxlength="255" class="textinput textInput form-control" required id="id_item">' 
        item_html += '</div>' 
        item_html += '</div>' 
        item_html += '<div class="form-group col-md-2 m-0" >' 
        item_html += '<div id="div_id_cost" class="mb-3">' 
        item_html += '<label for="id_cost" class="form-label requiredField">'
        item_html += 'Cost<span class="asteriskField">*</span>' 
        item_html += '</label>' 
        item_html += '<input type="number" name="cost" value="0" step="0.01" class="numberinput form-control" required id="id_cost">' 
        item_html += '</div>' 
        item_html += '</div>' 
        item_html += '<div class="form-group col-md-2 m-0" >' 
        item_html += '<div id="div_id_quantity" class="mb-3">' 
        item_html += '<label for="id_quantity" class="form-label requiredField">'
        item_html += 'Quantity<span class="asteriskField">*</span>' 
        item_html += '</label>' 
        item_html += '<input type="number" name="quantity" value="0" step="0.01" class="numberinput form-control" required id="id_quantity">' 
        item_html += '</div>' 
        item_html += '</div>' 
        item_html += '<div class="mb-3 form-group col-md-2 m-0"  id="div_id_item">' 
        item_html += '<label for="id_unit" class="form-label  requiredField">'
        item_html += 'Unit<span class="asteriskField">*</span>' 
        item_html += '</label>' 
        item_html += '<div>' 
        item_html += '<div class="input-group">' 
        item_html += '<select name="unit" class="select form-control" id="id_unit">' 
        item_html += '<option value="Cm">Cm</option> <option value="Kg">Kg</option>' 
        item_html += '<option value="L">L</option> <option value="Gb">Gb</option>' 
        item_html += '<option value="Mb">Mb</option> <option value="Piece" selected>Piece</option>' 
        item_html += '<option value="MÂ³">M3</option> <option value="Km">Km</option>' 
        item_html += '<option value="G">G</option>'
        item_html += '</select>' 
        item_html += '<button  class="btn btn fa fa-minus-circle" id="removeItem" type="button"></button>' 
        item_html += '</div>' 
        item_html += '</div>'
        item_html += '</div>'
        item_html += '</div>'
        
         // add row
        $("#button-id-add_item").click(function () {
            $('#item_row').append(item_html);
            // $('#div_id_action').clone().appendTo('#formRow');
        });
    
        // remove row
        $(document).on('click', '#removeItem', function () {
            $(this).closest('#itemFormRow').remove();
        });


        function cloneProduct(url){
            var newWindow = window.open(url);
    
            $( newWindow ).on( "load", function() {
                var doc = newWindow.document;
                const id_code = $('#id_code').text();
                const id_name = $('#id_name').text();
                const id_type = $('#id_type').text();
                const id_parent = $('#id_parent').text();
                const id_tax = $('#id_tax').text();
                const id_warehouse = $('#id_warehouse').text();
                const id_description = $('#id_description').text();
                const id_barcode = $('#id_barcode').text();
                const id_sell_price = $('#id_sell_price').text();
                const id_min_sell_price = $('#id_min_sell_price').text();
                const id_sell_price2 = $('#id_sell_price2').text();
                const id_sell_price3 = $('#id_sell_price3').text();
                const id_sell_price4 = $('#id_sell_price4').text();
                const id_sell_price5 = $('#id_sell_price5').text()
                const id_purchase_price = $('#id_purchase_price').text();
                const id_max_purchase_price = $('#id_max_purchase_price').text();
                const id_physical_stock = $('#id_physical_stock').text();
                const id_stock_limit = $('#id_stock_limit').text();
                const id_desired_stock = $('#id_desired_stock').text();
                const id_image = $('#id_image').text();
                const id_product_nature = $('#id_product_nature').text();
                const id_product_url = $('#id_product_url').text();
                const id_weight = $('#id_weight').text();
                const id_length = $('#id_length').text();
                const id_width = $('#id_width').text();
                const id_height = $('#id_height').text();
                const id_length_units = $('#id_length_units').text();
                const id_area = $('#id_area').text();
                const id_area_units = $('#id_area_units').text();
                const id_volume = $('#id_volume').text();
                const id_volume_units = $('#id_volume_units').text();
                const id_weight_units = $('#id_weight_units').text();
                const id_active_status = $('#id_active_status').text();
                const id_sell_status = $('#id_sell_status').text();
                const id_purchase_status = $('#id_purchase_status').text();
                const id_notes = $('#id_notes').text();

                console.log(id_weight);

                var year =  new Date().getSeconds();
                $('#id_code', doc).val(id_code.trim() + year ); 
                $('#id_name', doc).val(id_name.trim() + " CLONE" ); 
                // $('#id_type', doc).val(id_type.trim()); 
                // $('#id_parent', doc).val(id_parent.trim()); 
                // $('#id_tax', doc).text(id_tax.trim());
                // $('#id_warehouse', doc).text(id_warehouse.trim()); 
                $('#id_description', doc).val(id_description.trim()); 
                $('#id_barcode', doc).val(id_barcode.trim()); 
                $('#id_sell_price', doc).val(id_sell_price); 
                $('#id_min_sell_price', doc).val(id_min_sell_price.trim()); 
                $('#id_sell_price2', doc).val(parseFloat(id_sell_price2.trim())); 
                $('#id_sell_price3', doc).val(id_sell_price3.trim()); 
                $('#id_sell_price4', doc).val(id_sell_price4.trim()); 
                $('#id_sell_price5', doc).val(id_sell_price5.trim()); 
                $('#id_purchase_price', doc).val(id_purchase_price.trim()); 
                $('#id_max_purchase_price', doc).val(id_max_purchase_price.trim()); 
                $('#id_physical_stock', doc).val(id_physical_stock.trim()); 
                $('#id_stock_limit', doc).val(id_stock_limit.trim()); 
                $('#id_desired_stock', doc).val(id_desired_stock.trim()); 
                $('#id_image', doc).val(id_image.trim()); 
                $('#id_product_nature', doc).val(id_product_nature.trim()); 
                $('#id_product_url', doc).val(id_product_url.trim()); 
                $('#id_weight', doc).val(id_weight.trim()); 
                $('#id_length', doc).val(id_length.trim()); 
                $('#id_width', doc).val(id_width.trim()); 
                $('#id_height', doc).val(id_height.trim()); 
                $('#id_length_units', doc).val(id_length_units.trim()); 
                $('#id_area', doc).val(id_area.trim()); 
                $('#id_area_units', doc).val(id_area_units.trim()); 
                $('#id_volume', doc).val(id_volume.trim()); 
                $('#id_volume_units', doc).val(id_volume_units.trim()); 
                $('#id_weight_units', doc).val(id_weight_units.trim()); 
                // $('#id_active_status', doc).val(id_active_status.trim()); 
                // $('#id_sell_status', doc).val(id_sell_status.trim()); 
                // $('#id_purchase_status', doc).val(id_purchase_status.trim()); 
                $('#id_notes', doc).val(id_notes.trim());                 
            });

        };

        function cloneMaintenance(url){
            const maitenance_name = $( "h1" ).text();
            const type = $( "#type" ).text();
            const frequency = $( "#frequency" ).text();
            const time_allocated = $( "#time_allocated" ).text();
            const schedule = $( "#schedule" ).text();
            const time_schedule = $( "#time_schedule" ).text();

            var newWindow = window.open(url);

            $( newWindow ).on( "load", function() {
                
                newWindow.document.getElementById('id_name').value = maitenance_name;
                newWindow.document.getElementById('id_type').value = "" + type;
                newWindow.document.getElementById('id_frequency').value = parseFloat(frequency);
                newWindow.document.getElementById('id_time_allocated').value = parseFloat(time_allocated);
                newWindow.document.getElementById('id_schedule').value = "" + schedule;
                newWindow.document.getElementById('id_time_schedule').value = "" + time_schedule;
                
                var doc = newWindow.document;
                var item = $("#item_row", doc);
                var action = $("#add_action", doc);
                var i = 0;
                var x = 0;
                var itemMainArray = [];
                var actionMainArray = [];
                                
                $('#sortTableSmaller tr').each(function() {
                    if (!this.rowIndex) return; // skip first row
                    
                    x += 1;
                    html = $(html);

                    $('#id_action', $(html)).addClass('actionClass')
                    
                    action.append(html);
                    
                    var actionName = this.cells[1].innerHTML;
                    var actionNotes = this.cells[2].innerHTML;
                    
                    $('#id_action', doc).val(actionName);
                    $('#id_notes', doc).val(actionNotes);

                    var internalArray = [];

                    internalArray.push(actionName);
                    internalArray.push(actionNotes);
                    
                    actionMainArray.push(internalArray);

                });

                $('.actionClass', doc).each(function(i, obj) {
                    data = actionMainArray[i];
                    $(this).val(data[i]);
                });

                $('#sortTableSmall tr').each(function() {
                    if (!this.rowIndex) return; // skip first row
                    
                    i += 1;

                    item_html = $(item_html);

                    $('#id_item', $(item_html)).addClass('itemClass')
                    $('#id_cost', item_html).addClass('costClass')
                    $('#id_quantity', item_html).addClass('quantityClass')
                    $('#id_unit', item_html).addClass('unitClass')
                    
                    item.append(item_html);
                    
                    var itemName = this.cells[1].innerHTML;
                    var itemCost = this.cells[2].innerHTML;
                    var itemQuantity = this.cells[3].innerHTML;
                    var itemUnit = this.cells[4].innerHTML;
        
                    $('#id_item', doc).val(itemName);
                    $('#id_cost', doc).val(parseFloat(itemCost));
                    $('#id_quantity', doc).val(parseFloat(itemQuantity));
                    $('#id_unit', doc).val(itemUnit.trim());
                    
                    var internalArray = [];

                    internalArray.push(itemName);
                    internalArray.push(itemCost);
                    internalArray.push(itemQuantity);
                    internalArray.push(itemUnit);

                    itemMainArray.push(internalArray);

                });

                $('.itemClass', doc).each(function(i, obj) {
                    data = itemMainArray[i];
                    $(this).val(data[i]);
                });

                $('.costClass', doc).each(function(i, obj) {
                    data = itemMainArray[i];
                    console.log(data[1]);
                    $(this).val(parseFloat(data[1]));
                });

                $('.quantityClass', doc).each(function(i, obj) {
                    data = itemMainArray[i];
                    console.log(data[2]);
                    $(this).val(parseFloat(data[2]));
                });

                $('.unitClass', doc).each(function(i, obj) {
                    data = itemMainArray[i];
                    console.log(data[3]);
                    $(this).val((data[3]).toString().trim());
                });
            });
        } 
        
    </script>
    

</body>

</html>
